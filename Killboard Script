local Players = game:GetService("Players")

Players.PlayerAdded:Connect(function(Player) -- Runs code whenever a new player joins
	local leaderstats = Instance.new("Folder")
	leaderstats.Name = "leaderstats"
	leaderstats.Parent = Player

	local Kills = Instance.new("NumberValue") -- Amount of kills display 
	Kills.Name = "‚öî Kills"
	Kills.Value = 0
	Kills.Parent = leaderstats

	local Deaths = Instance.new("NumberValue") -- Amount of deaths display
	Deaths.Name = "üíÄ Deaths"
	Deaths.Value = 0
	Deaths.Parent = leaderstats
	
	local KDA = Instance.new("NumberValue") -- Average Kills to Death ratio (kills / death)
	KDA.Name = "‚≠ê KDA"
	KDA.Value = 0
	KDA.Parent = leaderstats
	
	local function UpdateKDA() -- Updates the leaderboard whenever a player's stat changes
		KDA.Value = Kills.Value / math.max(Deaths.Value, 1) -- math.max ensures no divide by 0
	end

	Kills.Changed:Connect(UpdateKDA)
	Deaths.Changed:Connect(UpdateKDA)

	Player.CharacterAdded:Connect(function(Character) -- Handles when player spawns
		local Humanoid = Character:WaitForChild("Humanoid")

		Humanoid.Died:Connect(function() -- When a player dies
			Deaths.Value = Deaths.Value + 1 
			local Tag = Humanoid:FindFirstChild("creator") -- Checks if someone killed them
			if Tag and Tag.Value and Tag.Value:IsA("Player") then
				local KilledPlayer = Tag.Value
				local KillsStat = KilledPlayer:FindFirstChild("leaderstats"):FindFirstChild("‚öî Kills")
				if KillsStat then -- Increases killer's stats
					KillsStat.Value = KillsStat.Value + 1
				end
			end
		end)
	end)
end)
